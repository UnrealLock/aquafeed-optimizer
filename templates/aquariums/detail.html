{% extends "base.html" %}
{% block title %}{{ aquarium.name }}{% endblock %}

{% block content %}

<div class="d-flex justify-content-between align-items-center mb-3">
  <h1 class="mb-0">{{ aquarium.name }}</h1>

  <div class="d-flex gap-2">
    <a href="{% url 'aquariums:list' %}" class="btn btn-outline-secondary btn-sm">Назад</a>
    <a href="{% url 'aquariums:delete' aquarium.pk %}" class="btn btn-outline-danger btn-sm">Удалить</a>
  </div>
</div>

<div class="row">
  <div class="col-md-6">
    <div class="card shadow-sm mb-4">
      <div class="card-body">
        <h5 class="card-title">Информация об аквариуме</h5>
        <ul class="list-unstyled mb-0">
          <li><strong>Объем:</strong> {{ aquarium.volume_liters }} л</li>
          <li><strong>Температура:</strong> {{ aquarium.temperature }} °C</li>
          <li><strong>Фильтрация:</strong> {{ aquarium.get_filtration_type_display }}</li>
        </ul>
      </div>
    </div>

    <div class="card shadow-sm mb-4">
      <div class="card-body">
        <h5 class="card-title">Подмены воды</h5>

        {% if water_changes %}
          <ul class="list-group mb-3">
            {% for wc in water_changes %}
              <li class="list-group-item">
                Каждые <strong>{{ wc.day_interval }}</strong> дней – <strong>{{ wc.percent }}</strong>%
              </li>
            {% endfor %}
          </ul>
        {% else %}
          <p class="text-muted">Подмены воды не настроены.</p>
        {% endif %}

        <h6 class="mt-3 mb-2">Настроить подмену воды</h6>
        <form method="post">
          {% csrf_token %}
          <input type="hidden" name="form_type" value="water_change">
          {{ water_change_form.as_p }}
          <button class="btn btn-primary btn-sm">Сохранить подмену</button>
        </form>
      </div>
    </div>

    <div class="card shadow-sm mb-4">
      <div class="card-body">
        <h5 class="card-title">Растения</h5>

        {% if plants %}
          <ul class="list-group">
            {% for plant in plants %}
              <li class="list-group-item d-flex justify-content-between align-items-center">
                <span>
                  {{ plant.plant.name }} × {{ plant.quantity }}
                </span>

                <a
                  href="{% url 'aquariums:delete_plant' plant.pk %}"
                  class="btn btn-sm btn-outline-danger"
                >
                  Удалить
                </a>
              </li>
            {% endfor %}
          </ul>
        {% else %}
          <p class="text-muted mb-0">Растения не добавлены.</p>
        {% endif %}
      </div>
    </div>

  </div>

  <div class="col-md-6">
    <div class="card shadow-sm mb-4">
      <div class="card-body">
        <h5 class="card-title">Рыбы</h5>

        {% if fish_list %}
          <ul class="list-group mb-3">
            {% for f in fish_list %}
              <li class="list-group-item d-flex justify-content-between">
                <span>{{ f.species.name }}</span>
                <span>x{{ f.count }}</span>
              </li>
            {% endfor %}
          </ul>
        {% else %}
          <p class="text-muted">Рыбы еще не добавлены.</p>
        {% endif %}

        <h6 class="mt-3">Установить количество рыб</h6>
        <form method="post">
          {% csrf_token %}
          <input type="hidden" name="form_type" value="fish">
          {{ form.as_p }}
          <button class="btn btn-primary btn-sm">Сохранить</button>
        </form>
      </div>
    </div>
  </div>
</div>

<div class="d-flex gap-2 mb-3">
  <a href="{% url 'aquariums:add_plant' aquarium.pk %}" class="btn btn-outline-success btn-sm">Добавить растение</a>
</div>

<a href="{% url 'feeding:plan_create' %}" class="btn btn-success">Рассчитать кормление</a>

{% endblock %}